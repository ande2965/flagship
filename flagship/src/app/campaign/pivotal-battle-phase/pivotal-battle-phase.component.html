<form>
    <h3>Declare {{ label }} Battle</h3>
    <p>
        The {{ declaringFaction === factions.Empire ? 'Imperial' : 'Rebel' }} team will
        declare this battle, choosing the battle's objective and location.
    </p>
    <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px">
        <mat-form-field fxFlex.gt-xs>
            <mat-label>Special Objective</mat-label>
            <mat-select [(ngModel)]="pivotalObjective" (selectionChange)="objectiveChanged()" name="obj" required>
                <mat-option *ngFor="let obj of pivotalObjectives" [value]="obj">
                    {{ obj }}
                </mat-option>
            </mat-select>
        </mat-form-field>
        <mat-form-field fxFlex.gt-xs *ngIf="pivotalObjective">
            <mat-label>Battle Location</mat-label>
            <mat-select [(ngModel)]="location" (selectionChange)="formChanged()" name="loc" required>
                <mat-option *ngFor="let loc of eligibleLocations" [value]="loc">
                    {{ loc.name }} [{{ loc.controlLabel() }}]
                </mat-option>
            </mat-select>
        </mat-form-field>
    </div>
    <p *ngIf="conquestObjective">
        <strong>Conquest:</strong> this battle will be played with the {{ conquestObjective.name }} objective.
    </p>
    <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="8px" *ngIf="location">
        <div *ngFor="let result of [attackerResult, defenderResult]; let first = first; let index = index;"
            fxFlex.gt-xs>
            <h4>
                {{ result.faction === factions.Empire ? "Empire" : "Rebels" }}
                ({{ first ? "Attacker" : "Defender" }})
            </h4>
            <div fxLayout="column" fxLayout.gt-xs="row" fxLayoutGap="4px" fxLayoutAlign="start center">
                <mat-form-field fxFlex>
                    <mat-label>Total Team Fleet Points</mat-label>
                    <input matInput [(ngModel)]="result.fleetPoints" (ngModelChange)="formChanged()"
                        name="{{ 'result-tfp-' + index }}" required type="number" />
                </mat-form-field>
                <mat-form-field fxFlex>
                    <mat-label>Score</mat-label>
                    <input matInput [(ngModel)]="result.score" (ngModelChange)="formChanged()"
                        name="{{ 'result-score-' + index }}" required type="number" />
                </mat-form-field>
            </div>
        </div>
    </div>
    <div *ngIf="reward">
        <h4>Battle Outcome</h4>
        <p>
            {{ reward.winningFaction === factions.Empire ? 'Imperial' : 'Rebel' }} team wins with a
            margin of victory of {{ reward.marginOfVictory }} points.
            {{ reward.winningFaction === factions.Empire ? 'Imperial' : 'Rebel' }} team will receive
            {{ reward.winnerCampaignPoints }} campaign points.
        </p>
        <p>
            {{ reward.winningFaction === factions.Empire ? 'Imperial' : 'Rebel' }} team commanders will
            receive {{ reward.winningTeamXP }} XP each.
        </p>
        <p>
            {{ reward.winningFaction === factions.Empire ? 'Rebel' : 'Imperial' }} team commanders will
            receive {{ reward.losingTeamXP }} XP each.
        </p>
    </div>
    <flagship-issues-list [issues]="issues">
    </flagship-issues-list>
</form>